{"version":3,"file":"serie.2b21312e.js","sources":["../../src/pages/serie.jsx"],"sourcesContent":["import { For, batch, createEffect, on } from 'solid-js';\nimport { createStore, produce } from 'solid-js/store';\nimport { useNavigate, useParams } from 'solid-app-router';\n\nimport { createLocalStore, createLocalSignal } from '../data/store'\n\nimport './general.sass'\nimport './serie.sass'\n\nexport default () => {\n\tconst params = useParams()\n\tconst navigate = useNavigate()\n\tconst [series, setSeries] = createLocalStore('Series')\n\tconst serieIndex = series.findIndex(s => s.name === params.serie)\n\tconst [seasons, setSeasons] = createStore(series[serieIndex].seasons)\n\tconst activeSeason = seasons.findIndex(e => e.some(it => !it))\n\tconst [expand, setExpand] = createStore(seasons.map((_, i) => activeSeason === i))\n\tconst [addCount, setAddCount] = createLocalSignal('AddCount', 1)\n\tconst addSeason = () => batch(() => {\n\t\tsetSeasons(s => [...s, []])\n\t\tsetExpand(e => [...e, true])\n\t})\n\tconst removeSeason = () => batch(() => {\n\t\tsetSeasons(s => s.slice(0, s.length - 1))\n\t\tsetExpand(e => e.slice(0, e.length - 1))\n\t})\n\tconst addEpisode = index => batch(() => {\n\t\tsetSeasons(index, it => [...it, 0])\n\t\tsetExpand(index, () => true)\n\t})\n\tconst removeEpisode = index => batch(() => {\n\t\tsetSeasons(index, it => it.slice(0, it.length - 1))\n\t\tsetExpand(index, () => true)\n\t})\n\tconst addEpisodes = index => batchEpisodeChange(() => addEpisode(index))\n\tconst removeEpisodes = index => batchEpisodeChange(() => removeEpisode(index))\n\tconst batchEpisodeChange = action => batch(() => Array.from({ length: addCount() }).forEach(action))\n\tconst toggleState = (index, episode) => setSeasons(index, produce(it => it[episode] = intNot(it[episode])))\n\tconst intNot = num => num ? 0 : 1\n\tcreateEffect(() => batch(() => {\n\t\tsetSeries(serieIndex, { name: params.serie, seasons: seasons })\n\t}))\n\tfunction addCountChanged(e) {\n\t\tconst num = e.currentTarget.valueAsNumber\n\t\tsetAddCount(num)\n\t\tif (!num || num <= 1)\n\t\t\tsetAddCount(1)\n\t}\n\tconst onBackPressed = () => navigate('/')\n\tconst onTitleClicked = index => setExpand(index, e => !e)\n\tconst titleClassByExpand = exp => `${exp ? 'middle-button' : 'left-round-button'}`\n\treturn <>\n\t\t<div class='middle'>\n\t\t\t<div id='title' class='round-button solid-button'>{params.serie}</div>\n\t\t</div>\n\t\t<div id='header1' class='spread'>\n\t\t\t<div class='button-stack'>\n\t\t\t\t<button class='left-button' onClick={addSeason}>\n\t\t\t\t\t<img class='center-image' src='add.svg'></img>\n\t\t\t\t</button>\n\t\t\t\t<div class='middle-button solid-button'>Season</div>\n\t\t\t\t<button class='right-button' onClick={removeSeason}>\n\t\t\t\t\t<img class='center-image' src='remove.svg'></img>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<button id='back-button' class='circle-button' onClick={onBackPressed}>\n\t\t\t\t<img src='left-arrow.svg' class='center-image'></img>\n\t\t\t</button>\n\t\t</div>\n\t\t<div id='header2' class='right-side'>\n\t\t\t<span>Â±</span>\n\t\t\t<input id='-add-count' type='number' value={addCount()} onInput={addCountChanged} />\n\t\t\t<span>episode{addCount() == 1 ? '' : 's'}</span>\n\t\t</div>\n\t\t<For each={seasons}>{(season, index) =>\n\t\t\t<>\n\t\t\t\t<div class='button-stack serie-title'>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass={titleClassByExpand(expand[index()])}\n\t\t\t\t\t\tonClick={() => onTitleClicked(index())}\n\t\t\t\t\t>\n\t\t\t\t\t\tSeason {index() + 1}\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class='rect-button' onClick={() => addEpisodes(index())}>\n\t\t\t\t\t\t<img class='center-image' src='add.svg'></img>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class='right-button' onClick={() => removeEpisodes(index())}>\n\t\t\t\t\t\t<img class='center-image' src='remove.svg'></img>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<details open={expand[index()]}>\n\t\t\t\t\t<summary style='display:none;'></summary>\n\t\t\t\t\t<div class='reverse-middle-button solid-button season-content'>\n\t\t\t\t\t\t<For each={season}>{(state, episode) =>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`episode ${state ? 'seen' : 'new'}`}\n\t\t\t\t\t\t\t\tonClick={() => toggleState(index(), episode())}>\n\t\t\t\t\t\t\t\tEpisode {episode() + 1}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t</For>\n\t\t\t\t\t</div>\n\t\t\t\t</details>\n\t\t\t</>\n\t\t}\n\t\t</For>\n\t</>\n}\n"],"names":["serie","params","useParams","navigate","useNavigate","series","setSeries","createLocalStore","serieIndex","findIndex","s","name","seasons","setSeasons","createStore","activeSeason","e","some","it","expand","setExpand","map","_","i","addCount","setAddCount","createLocalSignal","addSeason","batch","removeSeason","slice","length","addEpisode","index","removeEpisode","addEpisodes","batchEpisodeChange","removeEpisodes","action","Array","from","forEach","toggleState","episode","produce","intNot","num","createEffect","addCountChanged","currentTarget","valueAsNumber","onBackPressed","onTitleClicked","titleClassByExpand","exp","_el$","_tmpl$","_el$2","_$insert","_el$3","_tmpl$2","_el$4","_el$5","_el$6","_el$7","_el$8","_el$9","_tmpl$3","_el$10","_el$11","_el$12","_$effect","_$createComponent","For","season","_el$14","_tmpl$4","_el$15","_el$17","_el$18","_$className","_el$19","_tmpl$5","_el$20","_el$21","state","_el$22","_tmpl$6","_$delegateEvents"],"mappings":"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"}